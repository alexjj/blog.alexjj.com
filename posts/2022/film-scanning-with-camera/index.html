<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Alex Johnstone">
<meta name="dcterms.date" content="2022-10-26">

<title>Alex Johnstone - Film scanning with my digital camera</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "?",
    "H"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../../styles.css">
<meta property="og:title" content="Alex Johnstone - Film scanning with my digital camera">
<meta property="og:description" content="First attempts at scanning with digital">
<meta property="og:image" content="https://alexjj.com/posts/2022/film-scanning-with-camera/camera-scanning-thumb.jpg">
<meta property="og:site_name" content="Alex Johnstone">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../img/cat-logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Alex Johnstone</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../index.xml"> <i class="bi bi-rss-fill" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://wiki.alexjj.com"> <i class="bi bi-globe" role="img">
</i> 
<span class="menu-text">Wiki</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://gm5alx.uk"> <i class="bi bi-broadcast-pin" role="img">
</i> 
<span class="menu-text">GM5ALX</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Film scanning with my digital camera</h1>
<p class="subtitle lead">First attempts at scanning with digital</p>
  <div class="quarto-categories">
    <div class="quarto-category">Photography</div>
    <div class="quarto-category">Film</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Alex Johnstone </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 26, 2022</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>A few weeks ago I managed my first successful attempt at film development. Whilst I was very excited that it worked, the next thing was actually seeing the images. I did take a tiny picture of several frames using my phone and the filmdev app. That was fun just to see that there was something.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="quick-scan.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1" title="Quick scan with phone"><img src="quick-scan.jpg" title="Quick scan with phone" class="img-fluid figure-img" alt="Quick scan with phone"></a></p>
<figcaption>Quick scan with phone</figcaption>
</figure>
</div>
<p>The next thing is making larger images. My two choices were scanning onto the computer or dark room printing. Unfortunately, I don’t have a darkroom (although I do want to somehow make one in the garage), so scanning it is. When I scanned my grandfather’s slides I used a dedicated 35mm/slide scanner. The Plustek 8200 or something, together with Silverfast AI. The scanner is slow, the software is very weird, but once you figured out the routine you could steadily work your way through them all. In my wisdom, I’d sold the Plustek after finishing the slides - actually made money on it, which when I then came to look at buying another realised that this is because the prices are going up, and still going up, for used models. Another option is a flatbed scanner, but those are quite expensive and sounded more annoying for 35mm.</p>
<p>The final option is using a digital camera. As I have a digital camera, this did seem the more sensible option. However, you do need quite a few other things to make it all work. Namely a tripod or stand, light source, macro lens, and something to hold the film/black out around it. Like all things you can spend a fortune on any one of these items. I tried not to but the macro lens was never going to be cheap. I went for the Fuji 60mm f/2.4 as I thought it would also be useful as a mid-range portrait lens. I’ve never used it for that but I still might. However, having used it for scanning I’m not sure I like it for that. I’ve found manual focus is more reliable and helps speed up the process once it’s dialled in and the 60mm’s focus by wire isn’t that great. Perhaps I’ll look to sell it and get a manual focus one - assuming it’s a net cost to me.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="filmscanning.jpeg" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2" title="First attempts with a terrible tripod"><img src="filmscanning.jpeg" title="First attempts with a terrible tripod" class="img-fluid figure-img" alt="First attempts with a terrible tripod"></a></p>
<figcaption>First attempts with a terrible tripod</figcaption>
</figure>
</div>
<p>Back when I did my first development on 4x5, I tried a cheapo camera stand thing and a home made, black card mask. The mask was actually fine but the tripod stand thing was absolutely terrible. Wobbly and hard to adjust. It went straight back and I shelled out for a reasonable tripod. I had to find one that let me rotate the pole around so the camera can be mounted underneath. This is much more stable, secure and makes it easy to keep things parallel. For 35mm I think a home made mask might get tedious, so I went with an <a href="https://clifforth.co.uk/">essential film holder</a>. This gets lots of great reviews online, and as far as holders go it’s a cheap one - although still £75…</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="camera-scanning-thumb.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3" title="A much nicer tripod and film holder"><img src="camera-scanning-thumb.jpg" title="A much nicer tripod and film holder" class="img-fluid figure-img" alt="A much nicer tripod and film holder"></a></p>
<figcaption>A much nicer tripod and film holder</figcaption>
</figure>
</div>
<p>The fold out screen of the X-E4 is very handy for lining stuff up and changing settings. It flips the display when the screen moves past a certain angle which is ideal, it does mean the menu navigation is backwards but I can get used to that. I should make a preset for scanning so that I can get going quicker next time, as changing settings is a bit of a hassle as I then have to change them back later. I think I’ve messed up one of my presets so I’ll have to check that next time I’m using the camera. The macro lens isn’t quite long enough to get the film to completely fill the screen/sensor, extension tubes could fix that, or a longer lens. Maybe 80mm or 100mm? It’s not too big a deal as I just crop in post, which I’d do anyway. It also makes it quick to align as I’m not trying to hit it perfect straight away. Probably means my images are 12-14 megapixel vs.&nbsp;the cameras 26. Still plenty big enough.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="camera-scanning-1.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4" title="Camera close up"><img src="camera-scanning-1.jpg" title="Camera close up" class="img-fluid figure-img" alt="Camera close up"></a></p>
<figcaption>Camera close up</figcaption>
</figure>
</div>
<p>I spent a lot of time faffing about with trying to do tethered photos with Lightroom on the computer. Eventually realised that my copy of lightroom needs a paid for add-on to do it with Fuji. I then tried Fuji’s X Acquire but I couldn’t get it to work. The instructions said to put the camera in a certain mode, but my settings didn’t have that option, only for a webcam, so I don’t know. I also tried using the remote app on my phone but it was too slow and awkward for focusing. I was concerned about camera shake, but I just ended up using the 2 second delay to take the photos. This worked well, except it makes a really loud beeping sound which annoyed my wife in the other room whilst she was watching TV!</p>
<p>Just to add to it all, my battery was very low and all the fiddling around I’d been doing meant it died after a few shots.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="scan-from-camera.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="quarto-lightbox-gallery-5" title="The starting point"><img src="scan-from-camera.png" title="The starting point" class="img-fluid figure-img" alt="The starting point"></a></p>
<figcaption>The starting point</figcaption>
</figure>
</div>
<p>Once I got the first image in focus with peaking and zooming it, I could quite quickly move between frames and capture the whole roll in not much time at all. I think with a scanning preset setup on the camera, next time should be very quick.</p>
<p>I then spent ages fighting with Lightroom again until I realised my copy, again, was too old and didn’t support my camera’s raw files. So that was the end of Lightroom. When I went to bed that night I realised I could use another program to convert the RAFs to DNGs and use Lightroom.</p>
<p>I have a copy of Capture One Express for Fujifilm, so I thought I’d try that out, as all the negatives are, well, negative, I need to invert them and crop them at a minimum before I have useable images. C1ex seems a little buggy as it would crash when I’d try and customise the menu bars but I soon found my groove with it. Probably all photo editors can do it, but copying and pasting settings, and everything having a keyboard shortcut made editing (once I got the hang of it), very quick. I probably spent 20 minutes on the first two images, and then 10 on the other 26. (I seem to only have 28 from my 36 roll 😕)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="flip-the-curve.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="quarto-lightbox-gallery-6" title="Flip the curve"><img src="flip-the-curve.png" title="Flip the curve" class="img-fluid figure-img" alt="Flip the curve"></a></p>
<figcaption>Flip the curve</figcaption>
</figure>
</div>
<p>There are loads of film conversion tools out there and it’s overwhelming. Either as standalone things or plugins to various programs - typically Lightroom, or Photoshop. Negative Lab Pro seems to be the most common/popular one, it’s for LrC, but given all my heartache with Lightroom, I’ve not tried it yet. I think these plugins are probably most useful for colour negatives. Black and white is fairly easy. The common method of “flipping the curve”, i.e.&nbsp;move the ends of the line to the opposite of where they start, does the job. I then cropped out the blank area, and film edges, hit auto, tweaked a few things like exposure and blacks/whites and the image is good to go! Then paste the settings to the rest and crop them.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="final-image.jpg" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7" title="The final output"><img src="final-image.jpg" title="The final output" class="img-fluid figure-img" alt="The final output"></a></p>
<figcaption>The final output</figcaption>
</figure>
</div>
<p>I later found moving saturation all the way to zero ensured my images were black and white and didn’t have some blue tinge from the white balance setting. Usually auto was fine, but sometimes I had to use the white balance picker to find a suitable white part to get it right. I did scan all the images upside down, so next time I can fix that.</p>
<p>I’m pleased with the results, and it’s nice to have done the whole thing from exposing the photo, developing the film to scanning and processing it myself. Now that I’ve done it once, and know what I’m doing, and together with some pre-configuration of camera and setup, I think the next roll will be pretty quick to do. As long as I’ve charged the battery first!</p>


<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Quick scan with phone</span>
<span class="glightbox-desc lightbox-desc-2">First attempts with a terrible tripod</span>
<span class="glightbox-desc lightbox-desc-3">A much nicer tripod and film holder</span>
<span class="glightbox-desc lightbox-desc-4">Camera close up</span>
<span class="glightbox-desc lightbox-desc-5">The starting point</span>
<span class="glightbox-desc lightbox-desc-6">Flip the curve</span>
<span class="glightbox-desc lightbox-desc-7">The final output</span>
</div>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions"><ul><li><a href="https://github.com/alexjj/alexjj.com/blob/main/posts/2022/film-scanning-with-camera/index.md" class="toc-action"><i class="bi bi-github"></i>View source</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"openEffect":"zoom","closeEffect":"zoom","selector":".lightbox","descPosition":"bottom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>